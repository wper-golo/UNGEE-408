停止-等待协议是如何实现可靠传输的：

## 确认与否认机制：
![[image-20221127153505676.png]]

如果发送方传输的数据存在问题，接收方在接受并且识别到数据存在问题，就会返回NAK表示当前数据存在问题，然后丢弃错误数据。发送方接收到接收方传来的NAK，会重传数据。

## 超时重传机制

![[image-20221127153952936.png]]

## 确认丢失机制

![[image-20221127154101759.png]]

为避免上面的情况导致分组重复错误，必须得给发送的分组带上序号
接收端识别到第二次传来的DATA0分组和第一次传来的分组是同一分组，就直接丢弃，重新传回ACK
>在停止-等待协议中，由于每发送完成一个数据分组就停止等待，所以只需要保证和上次分组不是同一个序号就行，所以只需要1个比特位来进行编号就够了。（**确认分组同样需要编号**）

## 确认迟到机制

![[image-20221127154724879.png]]


## 停止-等待协议的信道利用率

有如下假设：
- TD：发送方发送数据分组所消耗的发送时延
- RTT：收发双方之间的往返时间
- TA：接收方发送确认分组所消耗的发送时延

由于数据分组长度的原因，TA一般远小于TD，可以忽略不及；但当RTT远大于TD时，信道利用率一般非常低

![[image-20221129173305786.png]]

## 注意
- 超时计时器的时间设置——略大于“从发送方到接收方的平均往返时间 ”
- 像停止-等待协议这样通过确认和重传机制实现的可靠传输协议，常被称为**自动请求重传协议ARQ（Automatic Repeat reQuest）**，意思是重传的请求是自动进行，不需要接收方显式地请求重传