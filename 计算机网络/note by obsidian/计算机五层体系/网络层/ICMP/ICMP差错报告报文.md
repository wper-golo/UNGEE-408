ICMP差错报告报文共有以下五种：
- 终点不可达（路由不可达）
- 源点抑制（路由拥塞）
- 时间超过（路由太长/回路）
- 参数问题（内容错误）
- 改变路由（重定向）（存在更好路由）


# 终点不可达

当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。
具体可以根据ICMP的代码字段细分为：
- 目的网络不可达
- 目的主机不可达
- 目的协议不可达
- 目的端口不可达
- 目的网络未知
- 目的主机位置
等13种错误
![[image-20221115093838126.png]]

# 源点抑制

当路由器或主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据包的发送速率放慢
![[image-20221115094110830.png]]

# 时间超过

- 当路由器收到一个目的IP不是自己的IP数据报，会将其生存时间TTL字段值减一。若结果不为0，则将该IP数据报继续转发出去；若结果为0，则丢弃该IP数据报，并向源点发送时间超过报文。![[image-20221115094350565.png]]
- 当终点在预先规定的时间内不能收到一个数据报的全部数据报片段时，就会把已收到的所有数据报片段都丢弃，并向源点发送时间超过报文

# 参数问题

当路由器或目的主机收到IP数据报后，根据其首部中的校验和字段发现首部在传输过程中出现了误码，就丢弃该数据报，并向源点发送参数问题的报文。
![[image-20221115094744224.png]]

# 改变路由（重定向）

路由器吧改变路由报文发送给主机，让主机知道下次发送数据报应发送给另外的路由器。（存在更好的路由）
![[image-20221115095014075.png]]

# 不发送ICMP差错报告报文的情况
- 对ICMP差错报告报文不再发送ICMP差错报告报文
- 对第一个分片的数据报片段的所有后续数据报片段报文都不再发送ICMP差错报告报文
- 对具有多播地址的数据报都不发送ICMP差错报告报文
- 对具有特殊地址（如：127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文
